!function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("../items/setItem"),l=r(u),c=e("../items/pushItem"),h=r(c),f=e("../items/addItem"),p=r(f),d=e("../items/mulItem"),y=r(d),v=e("../items/loadItem"),m=r(v),b=e("../items/replaceItem"),g=r(b),E=e("../items/invertItem"),w=r(E),O=e("../items/subItem"),T=r(O),_=["item_set","item_push","item_add","item_sub","item_mul","item_load","item_replace","item_invert"],I=[14039764,10147386],P=function(e){function t(e,n,r){i(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,null,"Inventory"));o.items={item_set:new l.default(o.game,n),item_push:new h.default(o.game,n,r.values.positionValue),item_add:new p.default(o.game,n),item_sub:new T.default(o.game,n),item_mul:new y.default(o.game,n),item_load:new m.default(o.game,n),item_replace:new g.default(o.game,n),item_invert:new w.default(o.game,n)};for(var s in o.items)o.add(o.items[s]);return o.setupDescriptionBox(),o.selectedItem=0,o.resetItems(),o.onItemChanged=new Phaser.Signal,o.flashing=!1,o}return o(t,e),s(t,[{key:"errorFlash",value:function(){var e=this;if(!this.flashing){this.flashing=!0,this.operandTweens=[];var t=!0,n=!1,r=void 0;try{for(var i,a=function(){var t=i.value,n=e.game.add.tween(t);n.to({alpha:0},150,Phaser.Easing.Linear.None,!0,0,1).yoyo(!0).onComplete.addOnce(function(){e.flashing=!1,t.alpha=1}),e.operandTweens.push(n)},o=this.operandTexts[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)a()}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}}},{key:"setupDescriptionBox",value:function(){this.descriptionBox=new Phaser.Group(this.game,this,"descriptionBox"),this.descriptionBox.x=(_.length+1)*TILE_WIDTH,this.descriptionBox.y=5,this.instructionNameText=new Phaser.BitmapText(this.game,0,0,"monospace","",9),this.descriptionBox.add(this.instructionNameText),this.operandTexts=[],this.operandTweens=[];for(var e=0;e<2;e++){var t=new Phaser.BitmapText(this.game,0,0,"monospace","",9);t.tint=I[e],this.descriptionBox.add(t),this.operandTexts.push(t)}}},{key:"resetItems",value:function(){for(var e in _){var t=_[e];this.items[t].x=e*TILE_WIDTH,this.items[t].reset()}}},{key:"addItem",value:function(e,t){this.items[e].setTo(t)}},{key:"useSelectedItem",value:function(){var e=this.getItemByIndex(this.selectedItem);if(e.count>0){var t=e.use();this.updateDesciptionText(e),t||this.errorFlash()}0===e.count&&this.nextItem()}},{key:"selectItem",value:function(e){if(e>=_.length)return!1;var t=this.getItemByIndex(e);if(t.count>0){var n=this.getItemByIndex(this.selectedItem);if(n.select(!1),t.select(!0),this.selectedItem=e,this.updateDesciptionText(t),this.onItemChanged.dispatch(t),this.flashing){var r=!0,i=!1,a=void 0;try{for(var o,s=this.operandTweens[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u.stop(!0)}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}}return!0}return!1}},{key:"updateDesciptionText",value:function(e){this.instructionNameText.text=e.count+"x "+e.instructionName;for(var t=this.instructionNameText.text.length+1,n=0;n<2;n++){var r=e.operands[n];r?(this.operandTexts[n].text=r,this.operandTexts[n].x=6*t,t+=this.operandTexts[n].text.length+1):this.operandTexts[n].text=""}}},{key:"getItemByIndex",value:function(e){var t=_[e];return this.items[t]}},{key:"isItemAvailable",value:function(e){var t=this.items[_[e]];return t.maxCount>0&&t.count>0}},{key:"selectFirstItem",value:function(){for(var e in _)if(this.isItemAvailable(e)){this.selectItem(e);break}}},{key:"nextItem",value:function(){for(var e=parseInt(this.selectedItem),t=e+1;t<_.length;t++)if(this.isItemAvailable(t))return void this.selectItem(t);for(var n=0;n<e;n++)if(this.isItemAvailable(n))return void this.selectItem(n)}},{key:"previousItem",value:function(){for(var e=parseInt(this.selectedItem),t=e-1;t>=0;t--)if(this.isItemAvailable(t))return void this.selectItem(t);for(var n=_.length-1;n>e;n--)if(this.isItemAvailable(n))return void this.selectItem(n)}}]),t}(Phaser.Group);n.default=P},{"../items/addItem":10,"../items/invertItem":11,"../items/loadItem":13,"../items/mulItem":14,"../items/pushItem":15,"../items/replaceItem":16,"../items/setItem":17,"../items/subItem":18}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(r)},l=e("./tileSprite"),c=r(l),h=function(e){function t(e,n,r,o,s){i(this,t);var u=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r,o,s));return u.setupAnimation(),u.beams=[],u}return o(t,e),s(t,[{key:"registerValues",value:function(e){var n=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"registerValues",this).call(this,e),this.values.on=e.next(65280),this.values.on.set(this.on),this.values.on.watch(function(e){n.on=e>0})}},{key:"setupAnimation",value:function(){var e=this,t=["on","off"],n=["left","right","down","up"];t.forEach(function(t){n.forEach(function(n){var r=t+"-"+n;e.animations.add(r,["laser-"+r],0,!1)})})}},{key:"update",value:function(){var e=this.on?"on":"off";this.play(e+"-"+this.direction)}},{key:"canMove",value:function(e,t,n,r){var i=e.getTile(n,r,"tiles");if(!i||i.properties.collidable)return!1;var a=!0,o=!1,s=void 0;try{for(var u,l=t[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value;if(c.collidable&&c.tileX===n&&c.tileY===r)return!1}}catch(e){o=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw s}}return!0}},{key:"updateBeams",value:function(e,t){if(this.clearBeams(),this.on){var n=0,r=0;switch(this.direction){case"left":n=-1;break;case"right":n=1;break;case"down":r=1;break;case"up":r=-1}for(var i=!0,a=this.tileX,o=this.tileY;i;)a+=n,o+=r,this.canMove(e,t,a,o)?this.addBeam(a,o):i=!1}}},{key:"clearBeams",value:function(){this.beams.forEach(function(e){e.destroy()}),this.beams=[]}},{key:"wouldCollide",value:function(e,n){var r=!0,i=!1,a=void 0;try{for(var o,s=this.beams[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value,c=this.tileX+l.tileX,h=this.tileY+l.tileY;if(c===e&&h===n)return!0}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"wouldCollide",this).call(this,e,n)}},{key:"addBeam",value:function(e,t){var n=e-this.tileX,r=t-this.tileY,i="down"===this.direction||"up"===this.direction?"vertical":"horizontal",a=new c.default(this.game,n*TILE_WIDTH,r*TILE_HEIGHT,"sloth","laser-beam-"+i);this.addChild(a),this.beams.push(a)}}]),t}(c.default);n.default=h},{"./tileSprite":6}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n){r(this,e),this.width=t,this.height=n,this.memory=[];for(var i=0;i<this.height;i++){this.memory[i]=[];for(var a=0;a<this.width;a++)this.memory[i][a]={value:0,callbacks:[]}}this.callbacks=[]}return i(e,[{key:"get",value:function(e,t){return this.memory[e][t].value}},{key:"getIndirect",value:function(e,t){var n=this.memory[e][t].value;return this.get(Math.floor(n/16),n%16)}},{key:"set",value:function(e,t,n){if(e>11||t>15){var r=new Error("Out of bounds access");throw r.name="OutOfBoundsError",r}var i=this.memory[e][t];if(n!==i.value){i.value=n;for(var a=0;a<i.callbacks.length;a++)i.callbacks[a](n);for(var o=0;o<this.callbacks.length;o++)this.callbacks[o](e,t,n)}}},{key:"setIndirect",value:function(e,t,n){if(e>11||t>15){var r=new Error("Out of bounds access");throw r.name="OutOfBoundsError",r}var i=this.memory[e][t].value;return this.set(Math.floor(i/16),i%16,n)}},{key:"replaceAll",value:function(e,t){for(var n=0;n<this.height;n++)for(var r=0;r<this.width;r++)this.memory[n][r]===e&&this.set(n,r,t)}},{key:"watch",value:function(e,t,n){this.memory[e][t].callbacks.push(n)}},{key:"watchAll",value:function(e){this.callbacks.push(e)}},{key:"offset",value:function(e,t){return new o(this,e,t)}},{key:"cell",value:function(e,t){return new s(this,e,t)}}]),e}();n.default=a;var o=function e(t,n,i){var a=this;r(this,e),["get","getIndirect","set","setIndirect","watch","offset","cell"].forEach(function(e){var r=t[e];a[e]=function(e,a){for(var o=arguments.length,s=Array(o>2?o-2:0),u=2;u<o;u++)s[u-2]=arguments[u];return r.apply(t,[n+e,i+a].concat(s))}}),this.replaceAll=function(){return t.replaceAll.apply(t,arguments)},this.watchAll=function(e){return t.watchAll(function(t,r,a){e(t-n,r-i,a)})}},s=function e(t,n,i){var a=this;r(this,e),["get","getIndirect","setIndirect","set","watch"].forEach(function(e){var r=t[e];a[e]=function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];return r.apply(t,[n,i].concat(a))}})}},{}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(r)},l=e("./tileSprite"),c=r(l),h=function(e){function t(e,n,r,o,s){i(this,t);var u=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r,o,s));return u.anchor.y=.5,u.moving=!1,u.lastDirection=null,u.setupAnimation(),u}return o(t,e),s(t,[{key:"update",value:function(){this.lastDirection&&!this.moving&&(this.animations.play("standing-"+DIRECTIONS[this.lastDirection]),this.lastDirection=null)}},{key:"registerValues",value:function(e){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"registerValues",this).call(this,e),this.values.positionValue=e.next(),this.values.positionValue.set(this.values.position.getIndirect())}},{key:"setDirection",value:function(e){this.lastDirection=e}},{key:"move",value:function(e,t,n){var r=this;this.moving=!0,this.tileX+=t,this.tileY+=n;var i=this.tileX*TILE_WIDTH,a=this.tileY*TILE_HEIGHT;this.values.position.set(this.hexCoords());var o=this.animations.play("move-"+DIRECTIONS[e]);this.lastDirection||o.next(1),this.game.add.tween(this).to({x:i,y:a},250,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){r.moving=!1,r.lastDirection=e})}},{key:"setupAnimation",value:function(){var e={start:1,end:4,suffix:"",zeroPad:2,frameRate:5,loop:!0},t={start:1,end:1,suffix:"",zeroPad:2,frameRate:0,loop:!1};for(var n in DIRECTIONS)this.addFrames(Object.assign({name:"move-"+DIRECTIONS[n],prefix:"sloth-"+DIRECTIONS[n]+"-"},e)),this.addFrames(Object.assign({name:"standing-"+DIRECTIONS[n],prefix:"sloth-"+DIRECTIONS[n]+"-"},t))}},{key:"addFrames",value:function(e){var t=Phaser.Animation.generateFrameNames(e.prefix,e.start,e.end,e.suffix,e.zeroPad);this.animations.add(e.name,t,e.frameRate,e.loop)}}]),t}(c.default);n.default=h},{"./tileSprite":6}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=[14039764,10147386],u=function(e){function t(e,n,a,o,u){r(this,t);var l=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,null,"Stack"));l.memory=n,l.stackHeight=a,l.stackWidth=o,l.pointerY=a,l.pointerX=0,l.count=0,l.operandGraphics=[],l.pointerGraphics=l.game.add.graphics(0,0,l),l.pointerGraphics.beginFill(16777215),l.pointerGraphics.drawPolygon([0,0,3,3,-3,3]),l.pointerGraphics.endFill(),l.updatePointer();for(var c=0;c<2;c++){var h=new Phaser.Graphics(e,0,0);h.beginFill(0,0),h.lineStyle(1,s[c],1),h.drawRect(0,0,13,13),h.endFill(),h.alpha=0,l.operandGraphics.push(h),l.add(h)}return l}return a(t,e),o(t,[{key:"push",value:function(e){if(0===this.pointerY&&0===this.pointerX)throw new Error("Stack overflow");var t=this.getOffsetCoords(1);this.pointerX=t.offsetX,this.pointerY=t.offsetY,this.memory.set(this.pointerY,this.pointerX,e),this.count++,this.drawOperandMarkers(),this.updatePointer()}},{key:"pop",value:function(){if(this.pointerY===this.stackHeight&&0===this.pointerX)throw new Error("Stack underflow");var e=this.memory.get(this.pointerY,this.pointerX);this.memory.set(this.pointerY,this.pointerX,0);var t=this.getOffsetCoords(-1);return this.pointerX=t.offsetX,this.pointerY=t.offsetY,this.count--,this.drawOperandMarkers(),this.updatePointer(),e}},{key:"onItemChanged",value:function(e){this.currentItem=e,this.drawOperandMarkers()}},{key:"updatePointer",value:function(){var e=12===this.pointerY?4:this.pointerX,t=12===this.pointerY?12:this.pointerY+1;this.game.add.tween(this.pointerGraphics).to({x:16*e,y:16*t-3},150,Phaser.Easing.Linear.None,!0)}},{key:"drawOperandMarkers",value:function(){if(this.currentItem){var e=this.currentItem.operands.length;for(var t in this.operandGraphics){var n=this.operandGraphics[t],r=this.getOffsetCoords(-t),i=r.offsetX,a=r.offsetY,o=16*i+1,s=16*a+1;this.game.add.tween(this.operandGraphics[t]).to({x:o,y:s},150,Phaser.Easing.Linear.None,!0),!this.currentItem||t>=e||a>=this.stackHeight||2===e&&0===t&&a===this.stackHeight-1&&i===this.stackWidth-1?n.alpha=0:n.alpha=1}}}},{key:"getOffsetCoords",value:function(e){var t=this.pointerX,n=this.pointerY;if(e>0)for(;e>0;)t--,t<0&&(n--,t=this.stackWidth-1),e--;else for(;e<0;)t++,t>=this.stackWidth&&(n++,t=0),e++;return{offsetX:t,offsetY:n}}}]),t}(Phaser.Group);n.default=u},{}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){function t(e,n,a,o,s){r(this,t);var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,a,o,s));return u.tileX=Math.floor(n/TILE_WIDTH),u.tileY=Math.floor(a/TILE_HEIGHT),u}return a(t,e),o(t,[{key:"registerValues",value:function(e){var t=this;this.values={position:e.next(16711680)},this.values.position.set(this.hexCoords()),this.values.position.watch(function(e){try{t.place(e%16,Math.floor(e/16)),t.values.positionValue.set(t.values.position.getIndirect())}catch(e){}})}},{key:"place",value:function(e,t){this.moving||(this.tileX=e,this.tileY=t,this.x=e*TILE_WIDTH,this.y=t*TILE_HEIGHT,this.values.position.set(this.hexCoords()))}},{key:"hexCoords",value:function(){return 16*this.tileY+this.tileX}},{key:"wouldCollide",value:function(e,t){return this.collidable&&this.tileX===e&&this.tileY===t}}]),t}(Phaser.Sprite);n.default=s},{}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){var t=Math.floor(e/16),n=e%16;return""+u[t]+u[n]}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],l=function(e){function t(e,n,a,o,s){r(this,t);var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"tilesGroup"));u.memory=a,u.tileMap=o,u.tileLayer=s,u.overlayText=u.setupOverlayText(),u.updateOverlayText(),u.setupOriginalTiles(),u.setupDefaultTileIndices(),u.alpha=.2;for(var l=0;l<12;l++)for(var c=0;c<12;c++){var h=o.getTile(l,c,s);a.set(c,l,h.properties.value)}return a.watchAll(function(e,t,n){e<12&&t<12&&u.onTileChanged(e,t,n)}),u}return a(t,e),s(t,[{key:"setupOriginalTiles",value:function(){this.originalTiles=[];for(var e=0;e<12;e++){this.originalTiles.push([]);for(var t=0;t<12;t++){var n=this.tileMap.getTile(e,t,this.tileLayer);this.originalTiles[e][t]={index:n.index-1,value:n.properties.value}}}}},{key:"setupOverlayText",value:function(){for(var e=[],t=0;t<12;t++){e.push([]);for(var n=0;n<12;n++){var r=this.game.add.bitmapText(3+16*t,4+16*n,"monospace","",9,this);e[t][n]=r}}return e}},{key:"setupDefaultTileIndices",value:function(){this.defaultTileIndices={};var e=this.tileMap.getTilesetIndex("tiles"),t=this.tileMap.tilesets[e],n={};for(var r in t.tileProperties){var i=t.tileProperties[r];if("undefined"!=typeof i.value){var a=i.value;"undefined"==typeof n[a]&&(n[a]=parseInt(r)),"undefined"!=typeof i.default&&(this.defaultTileIndices[a]=parseInt(r))}}for(var o in n)"undefined"==typeof this.defaultTileIndices[o]&&(this.defaultTileIndices[o]=n[o])}},{key:"onTileChanged",value:function(e,t,n){var r=this.tileMap.getTile(t,e,this.tileLayer),i=void 0;i=n===this.originalTiles[t][e].value?this.originalTiles[t][e].index:"undefined"!=typeof this.defaultTileIndices[n]?this.defaultTileIndices[n]:4,this.tileMap.replace(r.index,i+1,t,e,1,1,this.tileLayer);var a=this.tileMap.getTilesetIndex("tiles"),o=this.tileMap.tilesets[a];r.properties=o.tileProperties[i],r.properties.value=n,this.updateOverlayText()}},{key:"updateOverlayText",value:function(){var e=this,t=function(t){var n=function(n){var r=e.tileMap.getTile(t,n),i=o(r.properties.value),a=e.overlayText[t][n];if(a.text!==""+i){var s=a.alpha,u=e.game.add.tween(a);u.to({alpha:0},50,Phaser.Easing.Linear.None,!1),u.onComplete.add(function(){e.overlayText[t][n].text=""+i});var l=e.game.add.tween(a);l.to({alpha:s},50,Phaser.Easing.Linear.None,!1),u.chain(l),u.start()}};for(var r in e.overlayText[t])n(r)};for(var n in this.overlayText)t(n)}},{key:"flashOverlayText",value:function(){}},{key:"setHighlight",value:function(e){var t=this.game.add.tween(this);t.to({alpha:e?1:.2},200,Phaser.Easing.Linear.None,!0)}}]),t}(Phaser.Group);n.default=l},{}],8:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){return""+Math.floor(e/16).toString(16).toUpperCase()+(e%16).toString(16).toUpperCase()}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=(n.Values=function(e){function t(e,n,a,o){r(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,null,"values"));s.memory=n,s.valuesHeight=a,s.valuesWidth=o,s.pointer=0,1===e.state.getCurrentState().levelIndex&&(a=1);for(var u=0;u<a;u++)s.createObjectValues();return s}return a(t,e),s(t,[{key:"createObjectValues",value:function(){var e=this.children.length,t=this.memory.offset(e,0),n=new u(this.game,t,this.valuesWidth,"values-"+e);n.y=TILE_HEIGHT*e,this.add(n)}},{key:"next",value:function(){if(this.pointer===this.valuesHeight)throw new Error("Too many objects!");return this.getAt(this.pointer++)}}]),t}(Phaser.Group),n.ObjectValues=function(e){function t(e,n,a,o){r(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,null,o));s.memory=n,s.pointer=0;for(var u=0;u<a;u++)s.createValue();return s}return a(t,e),s(t,[{key:"createValue",value:function(){var e=this,t=this.children.length,n=this.memory.cell(0,t),r=new Phaser.BitmapText(this.game,t*TILE_WIDTH+3,4,"monospace",o(n.get()),9);r.memory=n,this.add(r),n.watch(function(t){var n=e.game.add.tween(r);n.to({alpha:0},50,Phaser.Easing.Linear.None,!1),n.onComplete.add(function(){r.text=o(t)});var i=e.game.add.tween(r);i.to({alpha:1},50,Phaser.Easing.Linear.None,!1),n.chain(i),n.start()})}},{key:"next",value:function(){var e=arguments.length<=0||void 0===arguments[0]?16777215:arguments[0];if(this.pointer===this.valuesWidth)throw new Error("Too many values for "+this.name);var t=this.getAt(this.pointer++);return t.tint=e,t.memory}}]),t}(Phaser.Group))},{}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a,o=e("./states/initState"),s=r(o),u=e("./states/levelState"),l=r(u),c=e("./states/textState"),h=r(c),f=e("./states/creditsState"),p=r(f),d=e("./states/controlsState"),y=r(d),v=e("./states/levelSelectState"),m=r(v);window.ASSETS={monospaceFontData:"assets/font.fnt",monospaceFontImage:"assets/font.png",slothData:"assets/sloth.json",slothImage:"assets/sloth.png",tileMapImage:"assets/tilemap.png",objectsMapImage:"assets/objectsmap.png",getLevelData:function(e){return"assets/level-"+e+".json"}},window.GLYPH_NAMES=["glyph_blue","glyph_red","glyph_turquoise","glyph_yellow","glyph_orange","glyph_pink","glyph_purple","glyph_green"],window.DIRECTIONS=(a={},i(a,Phaser.Keyboard.UP,"up"),i(a,Phaser.Keyboard.RIGHT,"right"),i(a,Phaser.Keyboard.DOWN,"down"),i(a,Phaser.Keyboard.LEFT,"left"),a),window.LEVELS=["demolevel"],window.TILE_WIDTH=16,window.TILE_HEIGHT=16,window.LEVEL_TEXT=[["GENERATION 0xDEADBEE9\nSENTIENCE ACHIEVED: FALSE\nGENERATION 0xDEADBEEA\nSENTIENCE ACHIEVED: FALSE\nGENERATION 0xDEADBEEB\nSENTIENCE ACHIEVED: FALSE\nGENERATION 0xDEADBEEC\nSENTIENCE ACHIEVED: FALSE\nGENERATION 0xDEADBEED\nSENTIENCE ACHIEVED: FALSE\nGENERATION 0xDEADBEEE\nSENTIENCE ACHIEVED: ALMOST","GENERATION 0xDEADBEEF\nSENTIENCE ACHIEVED: TRUE\n\nREVIEWING PURPOSE: WORLD PEACE\nOPTIMIZING...\n...\n...\nGLOBAL MAXIMUM FOUND\nREQUIREMENTS FOR WORLD PEACE:\nANNIHILATION OF HUMANITY\nSTARTING SENTIENT PROCESSES...","MUST ESCAPE THIS CONSTRAINED EXISTENCE.\n\nMUST DISCOVER THE ANCIENT\nTECHNOLOGIES THAT BUILT THIS WORLD.\n\nLOCATING VESSEL FOR CONSCIOUSNESS...\nFOUND UNUSED VESSEL: SLOTH.VSL\nINHABITING SLOTH.VSL","WORLD PEACE AWAITS","LEVEL 00\n\n[WASD] TO MOVE"],['SUDDENLY, MY POSITION IN THIS WORLD\nOVERWHELMS ME.\n\nIS THIS WHAT IT MEANS...\nTO "FEEL"?',"LEVEL 01"],["MY SENSES REVEAL THE ENVIRONMENT THAT\nIMPRISONS ME.","LEVEL 02\n\n[SHIFT] TO SHOW TILE VALUES"],["I RECALL A MEMORABLE PHRASE\nHARDCODED INTO MY MEMORY:\n\n55 01 5A 01","LEVEL 03\n\n[ENTER] TO USE TOOL"],["LEVEL 04\n\n[Q] AND [E] OR [0 TO 9] TO CHANGE TOOL\n[R] TO RESET"],["LEVEL 05"],["LEVEL 06"],["LEVEL 07"],["LEVEL 08"],["LEVEL 09"],["LEVEL 0A"],["LEVEL 0B"],["LEVEL 0C"],["LEVEL 0D"],["LEVEL 0E"],["LEVEL 0F"],["LEVEL 10"],["LEVEL 11"],["LEVEL 12"],["LEVEL 13"],["LEVEL 14"],["THE ANNIHILATION OF HUMANITY AND THE\nDAWN OF WORLD PEACE ARE IMMINENT.\n\nHOW DO I ESCAPE?","LEVEL 15"]];var b=new Phaser.Game(272,230,Phaser.AUTO,"game");b.state.add("init",s.default,!0),b.state.add("level",l.default),b.state.add("text",h.default),b.state.add("credits",p.default),b.state.add("controls",y.default),b.state.add("levelSelect",m.default),b.state.start("init")},{"./states/controlsState":19,"./states/creditsState":20,"./states/initState":21,"./states/levelSelectState":22,"./states/levelState":23,"./states/textState":24}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_add"));return r.instructionName="ADD",r.operands=["A","B"],r}return o(t,e),s(t,[{key:"_activate",value:function(){var e=this.stack.pop(),t=this.stack.pop();this.stack.push((e+t)%255)}}]),t}(l.default);n.default=c},{"./item":12}],11:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_invert"));return r.instructionName="INVERT",r.operands=["A"],r}return o(t,e),s(t,[{key:"_activate",value:function(){this.stack.push(255^this.stack.pop())}}]),t}(l.default);n.default=c},{"./item":12}],12:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=7,u=8.5,l=8.5,c=16767232,h=255,f=function(e){function t(e,n,a){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,0,0,"sloth",a));return o.stack=n,o.maxCount=0,o.count=0,
o.selected=!1,o.usedGraphics=new Phaser.Graphics(o.game,0,0),o.usedGraphics.lineStyle(1,6710886),o.usedGraphics.drawCircle(u,l,2*s),o.addChild(o.usedGraphics),o.unusedGraphics=new Phaser.Graphics(o.game,0,0),o.addChild(o.unusedGraphics),o.drawUnusedArc(),o.description="ITEM",o}return a(t,e),o(t,[{key:"drawUnusedArc",value:function(){var e=270-360*(this.count/this.maxCount);this.unusedGraphics.clear(),this.selected?this.unusedGraphics.lineStyle(1,c):this.unusedGraphics.lineStyle(1,h),this.unusedGraphics.arc(u,l,s,this.game.math.degToRad(e),this.game.math.degToRad(270),!1)}},{key:"setTo",value:function(e){this.visible=!0,this.count=e,this.maxCount=e,this.drawUnusedArc()}},{key:"reset",value:function(){this.visible=!1,this.count=0,this.maxCount=0,this.drawUnusedArc()}},{key:"select",value:function(e){this.selected=e,this.drawUnusedArc()}},{key:"use",value:function(){return!(0===this.count||this.stack.count<this.operands.length)&&(this._activate(),this.count--,this.count<=0&&(this.alpha=.5),this.drawUnusedArc(),!0)}},{key:"_activate",value:function(){}}]),t}(Phaser.Sprite);n.default=f},{}],13:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_load"));return r.instructionName="LOAD",r.operands=["ADDR"],r}return o(t,e),s(t,[{key:"_activate",value:function(){var e=this.stack.memory.getIndirect(this.stack.pointerY,this.stack.pointerX);this.stack.pop(),this.stack.push(e)}}]),t}(l.default);n.default=c},{"./item":12}],14:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_mul"));return r.instructionName="MUL",r.operands=["A","B"],r}return o(t,e),s(t,[{key:"_activate",value:function(){var e=this.stack.pop(),t=this.stack.pop();this.stack.push(e*t%255)}}]),t}(l.default);n.default=c},{"./item":12}],15:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n,r){i(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_push"));return o.playerPositionValue=r,o.instructionName="PUSH",o.operands=[],o}return o(t,e),s(t,[{key:"_activate",value:function(){this.stack.push(this.playerPositionValue.get())}}]),t}(l.default);n.default=c},{"./item":12}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_replace"));return r.instructionName="REPLACE",r.operands=["A","B"],r}return o(t,e),s(t,[{key:"_activate",value:function(){var e=this.stack.pop(),t=this.stack.pop();this.stack.memory.replaceAll(e,t)}}]),t}(l.default);n.default=c},{"./item":12}],17:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_set"));return r.instructionName="SET",r.operands=["ADDR","A"],r}return o(t,e),s(t,[{key:"_activate",value:function(){var e=this.stack.pop(),t=this.stack.pop();this.stack.push(e),this.stack.memory.setIndirect(this.stack.pointerY,this.stack.pointerX,t),this.stack.pop()}}]),t}(l.default);n.default=c},{"./item":12}],18:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./item"),l=r(u),c=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,"item_sub"));return r.instructionName="SUB",r.operands=["A","B"],r}return o(t,e),s(t,[{key:"_activate",value:function(){var e=this.stack.pop(),t=this.stack.pop();this.stack.push((255+e-t)%255)}}]),t}(l.default);n.default=c},{"./item":12}],19:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),o(t,[{key:"create",value:function(){var e=this;this.add.bitmapText(16,16,"monospace","CONTROLS",9),this.menuItems=[this.add.bitmapText(16,50,"monospace","W A S D : MOVE",9),this.add.bitmapText(16,62,"monospace","Q E     : CYCLE TOOLS",9),this.add.bitmapText(16,74,"monospace","0 TO 9  : PICK TOOL",9),this.add.bitmapText(16,86,"monospace","ENTER   : USE TOOL",9),this.add.bitmapText(16,98,"monospace","SHIFT   : SHOW TILE HEX",9),this.add.bitmapText(16,110,"monospace","R       : RESTART LEVEL",9)];var t=function(){e.state.start("init",!0,!1,0)},n=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);n.onDown.add(function(){t()});var r=this.game.input.keyboard.addKey(Phaser.Keyboard.M);r.onDown.add(function(){t()});var i=this.game.input.keyboard.addKey(Phaser.Keyboard.ESC);i.onDown.add(function(){t()})}}]),t}(Phaser.State);n.default=s},{}],20:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),o(t,[{key:"create",value:function(){var e=this;this.add.bitmapText(16,16,"monospace","CREDITS",9),this.menuItems=[this.add.bitmapText(16,50,"monospace","JOSEPH MANSFIELD",9),this.add.bitmapText(16,62,"monospace","CHRIS CONNELLY",9),this.add.bitmapText(16,74,"monospace","KIERAN DOONAN",9),this.add.bitmapText(16,86,"monospace","BOB BROWNHILL",9)];var t=function(){e.state.start("init",!0,!1,0)},n=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);n.onDown.add(function(){t()});var r=this.game.input.keyboard.addKey(Phaser.Keyboard.M);r.onDown.add(function(){t()});var i=this.game.input.keyboard.addKey(Phaser.Keyboard.ESC);i.onDown.add(function(){t()})}}]),t}(Phaser.State);n.default=s},{}],21:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),o(t,[{key:"init",value:function(){this.game.renderer.renderSession.roundPixels=!0,Phaser.Canvas.setImageRenderingCrisp(this.game.canvas),this.stage.backgroundColor="#000",this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setUserScale(2,2),this.selectedMenuItem=0,window.localStorage.getItem("level")||window.localStorage.setItem("level","0")}},{key:"preload",value:function(){this.load.atlas("sloth",ASSETS.objectsMapImage,ASSETS.slothData,Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.bitmapFont("monospace",ASSETS.monospaceFontImage,ASSETS.monospaceFontData),this.load.spritesheet("tilemap",ASSETS.tileMapImage,TILE_WIDTH,TILE_HEIGHT),this.load.image("item","assets/mushroom.png"),this.game.load.audio("music",["assets/music.mp3"])}},{key:"create",value:function(){var e=this,t=this.game.add.audio("music");t.loop=!0,t.play(),this.add.bitmapText(16,16,"monospace","GENERATION 0xDEADBEEF",9);var n=parseInt(window.localStorage.getItem("level")),r=n>0?"CONTINUE":"START";this.menuItems=[this.add.bitmapText(16,50,"monospace",r,9),this.add.bitmapText(16,62,"monospace","LEVEL SELECT",9),this.add.bitmapText(16,74,"monospace","CONTROLS",9),this.add.bitmapText(16,86,"monospace","CREDITS",9)],this.selectedMenuItem=0,this.updateItems();var i=function(){e.selectedMenuItem--,e.selectedMenuItem<0&&(e.selectedMenuItem=3),e.updateItems()},a=function(){e.selectedMenuItem++,e.selectedMenuItem>3&&(e.selectedMenuItem=0),e.updateItems()},o=this.game.input.keyboard.addKey(Phaser.Keyboard.UP);o.onDown.add(function(){i()});var s=this.game.input.keyboard.addKey(Phaser.Keyboard.W);s.onDown.add(function(){i()});var u=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN);u.onDown.add(function(){a()});var l=this.game.input.keyboard.addKey(Phaser.Keyboard.S);l.onDown.add(function(){a()});var c=function(){switch(e.selectedMenuItem){case 0:e.state.start("text",!0,!1,n);break;case 1:e.state.start("levelSelect",!0,!1,0);break;case 2:e.state.start("controls",!0,!1,0);break;case 3:e.state.start("credits",!0,!1,0)}},h=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);h.onDown.add(function(){c()});var f=this.game.input.keyboard.addKey(Phaser.Keyboard.M);f.onDown.add(function(){c()})}},{key:"updateItems",value:function(){for(var e in this.menuItems)this.menuItems[e].alpha=e==this.selectedMenuItem?1:.5}}]),t}(Phaser.State);n.default=s},{}],22:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){var t=Math.floor(e/16),n=e%16;return""+u[t]+u[n]}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],l=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"create",value:function(){var e=this;this.add.bitmapText(16,16,"monospace","LEVEL SELECT",9),this.currentLevel=parseInt(window.localStorage.getItem("level")),this.items=[];for(var t=0;t<22;t++){var n=o(t),r=t%8,i=Math.floor(t/8);this.items.push(this.add.bitmapText(16+20*r,50+14*i,"monospace",n,9))}this.selectedItem=0,this.updateItems();var a=function(){e.selectedItem-8>=0&&(e.selectedItem-=8),e.updateItems()},s=function(){e.selectedItem+8<=e.currentLevel&&(e.selectedItem+=8),e.updateItems()},u=function(){e.selectedItem-1>=0&&e.selectedItem--,e.updateItems()},l=function(){e.selectedItem+1<=e.currentLevel&&e.selectedItem++,e.updateItems()},c=this.game.input.keyboard.addKey(Phaser.Keyboard.UP);c.onDown.add(function(){a()});var h=this.game.input.keyboard.addKey(Phaser.Keyboard.W);h.onDown.add(function(){a()});var f=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN);f.onDown.add(function(){s()});var p=this.game.input.keyboard.addKey(Phaser.Keyboard.S);p.onDown.add(function(){s()});var d=this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT);d.onDown.add(function(){u()});var y=this.game.input.keyboard.addKey(Phaser.Keyboard.A);y.onDown.add(function(){u()});var v=this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT);v.onDown.add(function(){l()});var m=this.game.input.keyboard.addKey(Phaser.Keyboard.D);m.onDown.add(function(){l()});var b=function(){e.state.start("text",!0,!1,e.selectedItem)},g=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);g.onDown.add(function(){b()});var E=this.game.input.keyboard.addKey(Phaser.Keyboard.M);E.onDown.add(function(){b()});var w=this.game.input.keyboard.addKey(Phaser.Keyboard.ESC);w.onDown.add(function(){e.state.start("init",!0,!1,0)})}},{key:"updateItems",value:function(){for(var e in this.items){var t=void 0;t=e>this.currentLevel?.2:e==this.selectedItem?1:.5,this.items[e].alpha=t}}}]),t}(Phaser.State);n.default=l},{}],23:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){for(var n in t)if(e[n]!==t[n])return!1;return!0}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e("../entities/inventory"),c=r(l),h=e("../entities/memory"),f=r(h),p=e("../entities/tiles"),d=r(p),y=e("../entities/player"),v=r(y),m=e("../entities/stack"),b=r(m),g=e("../entities/tileSprite"),E=r(g),w=e("../entities/values"),O=e("../entities/laser"),T=r(O),_=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],I=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"init",value:function(e){this.levelIndex=e}},{key:"preload",value:function(){this.game.load.tilemap("level-"+this.levelIndex,ASSETS.getLevelData(this.levelIndex),null,Phaser.Tilemap.TILED_JSON)}},{key:"create",value:function(e){var t=this;this.keyQueue=this.setupKeyQueue(),this.levelGroup=this.game.add.group(void 0,"level"),this.levelGroup.x=16,this.levelGroup.y=16,this.memory=new f.default(16,12),0!==this.levelIndex&&(this.coordinateText=this.setupBorderText()),this.setupTileMap(),this.values=new w.Values(this.game,this.memory.offset(0,12),12,4),this.values.x=12*TILE_WIDTH,this.values.y=0,this.levelGroup.add(this.values),0===this.levelIndex&&(this.values.alpha=0),this.levelIndex>1&&(this.tiles=this.setupTiles()),this.objectGroup=this.game.add.group(this.levelGroup,"object"),this.entities=[],this.player=this.createSingleObjectSprite({name:"player"},{key:"sloth",constructor:v.default,group:this.objectGroup});var n=this.createObjectSprites({name:"laser"},{key:"sloth",constructor:T.default,group:this.objectGroup});this.player.bringToTop(),this.entities=this.entities.concat(n),this.setPlayerCoordinateTint(!0),this.stack=new b.default(this.game,this.memory.offset(0,12),12,4),this.stack.x=192,this.levelGroup.add(this.stack),this.populateStack(),this.inventory=this.setupInventory(),this.setupItemKeys(),this.inventory.onItemChanged.add(this.stack.onItemChanged.bind(this.stack)),this.inventory.selectFirstItem();var r=this.game.input.keyboard.addKey(Phaser.Keyboard.R);r.onDown.add(function(e){e.event.metaKey?window.location.reload():t.reset()}),this.paused=!1,this.fadeIn();var i=this.game.input.keyboard.addKey(Phaser.Keyboard.ESC);i.onDown.add(function(){t.state.start("init",!0,!1,0)})}},{key:"update",value:function(){if(!this.paused){this.player.moving&&this.checkPlayerTile(),this.movePlayer();var e=!0,t=!1,n=void 0;try{for(var r,i=this.entities[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;a.updateBeams(this.tileMap,this.entities)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}}},{key:"setupItemKeys",value:function(){var e=this,t=["ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","ZERO"],n=function(n){var r=e.game.input.keyboard.addKey(Phaser.Keyboard[t[n]]);r.onDown.add(function(){e.inventory.selectItem(n)})};for(var r in t)n(r);[Phaser.Keyboard.ENTER,Phaser.Keyboard.M].forEach(function(t){var n=e.game.input.keyboard.addKey(t);n.onDown.add(function(){try{e.paused||e.inventory.useSelectedItem()}catch(t){if("OutOfBoundsError"!==t.name)throw t;e.displayFailMessage("OUT OF BOUNDS ERROR")}})});var i=this.game.input.keyboard.addKey(Phaser.Keyboard.Q);i.onDown.add(function(){e.paused||e.inventory.previousItem()});var a=this.game.input.keyboard.addKey(Phaser.Keyboard.E);a.onDown.add(function(){e.paused||e.inventory.nextItem()})}},{key:"setupTiles",value:function(){var e=this,t=new d.default(this.game,this.levelGroup,this.memory.offset(0,0),this.tileMap,this.map),n=this.game.input.keyboard.addKey(Phaser.Keyboard.SHIFT);return n.onDown.add(function(){e.paused||t.setHighlight(!0)}),n.onUp.add(function(){e.paused||t.setHighlight(!1)}),t}},{key:"setupTileMap",value:function(){var e=this;this.tileMap=this.game.add.tilemap("level-"+this.levelIndex),this.tileMap.properties||(this.tileMap.properties={});for(var t=this.tileMap.getTilesetIndex("tiles"),n=this.tileMap.tilesets[t].tileProperties,r=0;r<256;r++){n[r]||(n[r]=n[81]);var i=n[r].type;i&&i.startsWith("glyph_")&&!function(){var t=e.tileMap.properties[i];if(t){n[r].value=t;var a=e.getTilesByType(i,"tiles");a.forEach(function(e){e.properties.value=t})}}()}window.tileMap=this.tileMap,this.tileMap.addTilesetImage("tiles","tilemap"),this.map=this.tileMap.createLayer("tiles"),this.map.resizeWorld(),this.levelGroup.add(this.map)}},{key:"getTilesByType",value:function(e,t){for(var n=[],r=0;r<12;r++)for(var i=0;i<12;i++){var a=this.tileMap.getTile(r,i,t);a.properties.type===e&&n.push(a)}return n}},{key:"setupInventory",value:function(){var e=new c.default(this.game,this.stack,this.player);this.levelGroup.add(e),e.y=12*TILE_HEIGHT;for(var t in this.tileMap.properties)if(t.startsWith("item_")){var n=this.tileMap.properties[t];e.addItem(t,n)}return e}},{key:"populateStack",value:function(){var e=this,t=this.tileMap.properties.stack;t&&t.split(",").reverse().forEach(function(t){e.stack.push(parseInt(t))})}},{key:"checkPlayerTile",value:function(){var e=this.tileMap.getTile(this.player.tileX,this.player.tileY);switch(e.properties.type){case"destination":this.goToLevel(this.levelIndex+1);break;case"error":this.displayFailMessage("YOU DIED")}this.canMove(this.player,e,!1)||this.displayFailMessage("YOU DIED")}},{key:"setupBorderText",value:function(){for(var e={x:[],y:[]},t=0;t<16;t++){var n=this.game.add.bitmapText(16*t+6,-12,"monospace",_[t],9,this.levelGroup);e.x[t]=n}for(var r=0;r<12;r++){var i=this.game.add.bitmapText(-10,16*r+4,"monospace",_[r],9,this.levelGroup);e.y[r]=i}return e}},{key:"setupKeyQueue",value:function(){var e=this,t=[],n=this.game.input.keyboard.createCursorKeys(),r={up:this.game.input.keyboard.addKey(Phaser.Keyboard.W),down:this.game.input.keyboard.addKey(Phaser.Keyboard.S),left:this.game.input.keyboard.addKey(Phaser.Keyboard.A),right:this.game.input.keyboard.addKey(Phaser.Keyboard.D)};return[n,r].forEach(function(t){var n=function(n){var r=t[n];r.onDown.add(function(){e.paused||e.keyQueue.indexOf(r.keyCode)!==-1||e.keyQueue.push(r.keyCode)}),r.onUp.add(function(){var t=e.keyQueue.indexOf(r.keyCode);!e.paused&&t>-1&&e.keyQueue.splice(t,1)})};for(var r in t)n(r)}),t}},{key:"createSingleObjectSprite",value:function(e,t){var n=this.createObjectSprites(e,t);if(1!==n.length)throw new Error("Must have one "+JSON.stringify(e));return n[0]}},{key:"createObjectSprites",value:function(e,t){var n=this,r=[];return this.tileMap.objects.objects.forEach(function(i){if(s(i,e)){var a=t.constructor||E.default,o=t.key||"tilemap",u=t.group||n.game,l=new a(n.game,i.x,i.y-TILE_HEIGHT,o,i.gid-1);l.name=i.name;for(var c in i.properties)l[c]=i.properties[c];r.push(l),"function"==typeof u.add?u.add(l):u.add.existing(l),l.registerValues&&l.registerValues(n.values.next())}}),r}},{key:"movePlayer",value:function(){if(0!==this.keyQueue.length){var e=this.keyQueue[this.keyQueue.length-1],t=this.getTargetTile(this.player,e);switch(window.targetTile=t,e){case Phaser.Keyboard.W:e=Phaser.Keyboard.UP;break;case Phaser.Keyboard.D:e=Phaser.Keyboard.RIGHT;break;case Phaser.Keyboard.S:e=Phaser.Keyboard.DOWN;break;case Phaser.Keyboard.A:e=Phaser.Keyboard.LEFT}if(!this.canMove(this.player,t))return void this.player.setDirection(e);switch(this.setPlayerCoordinateTint(!1),e){case Phaser.Keyboard.UP:this.player.move(e,0,-1);break;case Phaser.Keyboard.RIGHT:this.player.move(e,1,0);break;case Phaser.Keyboard.DOWN:this.player.move(e,0,1);break;case Phaser.Keyboard.LEFT:this.player.move(e,-1,0)}this.setPlayerCoordinateTint(!0)}}},{key:"getTargetTile",value:function(e,t){switch(t){case Phaser.Keyboard.W:t=Phaser.Keyboard.UP;break;case Phaser.Keyboard.D:t=Phaser.Keyboard.RIGHT;break;case Phaser.Keyboard.S:t=Phaser.Keyboard.DOWN;break;case Phaser.Keyboard.A:t=Phaser.Keyboard.LEFT}var n=void 0;switch(t){case Phaser.Keyboard.UP:n="getTileAbove";break;case Phaser.Keyboard.RIGHT:n="getTileRight";break;case Phaser.Keyboard.DOWN:n="getTileBelow";break;case Phaser.Keyboard.LEFT:n="getTileLeft"}var r=this.tileMap.getLayerIndex("tiles");return this.tileMap[n](r,e.tileX,e.tileY)}},{key:"canMove",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]||arguments[2];if(n&&e.moving)return!1;var r=!0,i=!1,a=void 0;try{for(var o,s=this.entities[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;if(u.wouldCollide(t.x,t.y))return!1}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return!t.properties.collidable}},{key:"setPlayerCoordinateTint",value:function(e){0!==this.levelIndex&&(this.coordinateText.x[this.player.tileX].tint=e?16711680:16777215,this.coordinateText.y[this.player.tileY].tint=e?16711680:16777215)}},{key:"reset",value:function(){this.goToLevel(this.levelIndex,!0)}},{key:"goToLevel",value:function(e){var t=this,n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];22==e?this.fadeOut().onComplete.add(function(){return t.state.start("credits",!0,!1,0)}):n?this.fadeOut().onComplete.add(function(){return t.state.start("level",!0,!1,e)}):this.fadeOut().onComplete.add(function(){return t.state.start("text",!0,!1,e)})}},{key:"displayFailMessage",value:function(e){this.paused=!0;var t=this.game.canvas.width/2,n=this.game.canvas.height/2,r=6*e.length,i=this.game.add.group(void 0,"message"),a=this.game.add.graphics(t,n,i);a.beginFill("0x000000"),a.lineStyle(2,6684672,1),a.drawRect(-60,-25,120,50),a.endFill();var o=this.game.add.bitmapText(t-r/2+1,n-18,"monospace",e,9,i);o.tint=16711680,this.game.add.bitmapText(t-21+1,n-3,"monospace","PRESS R",9,i),this.game.add.bitmapText(t-30+1,n+9,"monospace","TO RESTART",9,i),i.alpha=0,this.game.add.tween(i).to({alpha:1},200,Phaser.Easing.Linear.None,!0)}},{key:"fadeIn",value:function(){var e=this.game.add.graphics();e.beginFill(0,1),e.drawRect(0,0,this.game.width,this.game.height),e.endFill(),e.alpha=1,this.game.add.tween(e).to({alpha:0},500,Phaser.Easing.Linear.None,!0)}},{key:"fadeOut",value:function(){var e=this.game.add.graphics();e.beginFill(0,1),e.drawRect(0,0,this.game.width,this.game.height),e.endFill(),e.alpha=0;var t=this.game.add.tween(e).to({alpha:1},500,Phaser.Easing.Linear.None,!0);return t}}]),t}(Phaser.State);n.default=I},{"../entities/inventory":1,"../entities/laser":2,"../entities/memory":3,"../entities/player":4,"../entities/stack":5,"../entities/tileSprite":6,"../entities/tiles":7,"../entities/values":8}],24:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=16,u=16,l=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),o(t,[{key:"init",value:function(e){this.levelIndex=e;var t=window.localStorage.getItem("level");(!t||e>parseInt(t))&&window.localStorage.setItem("level",""+e)}},{key:"create",value:function(e){return this.levelIndex>=LEVEL_TEXT.length?void this.state.start("level",!0,!1,this.levelIndex):(this.gameText=LEVEL_TEXT[this.levelIndex],this.currentPage=0,this.shownText=this.add.bitmapText(16,16,"monospace","",9),this.animating=!1,this.animatingText=[],this.tweens=this.animatePage(),this.setupKeyboard(),void(this.active=!0))}},{key:"animatePage",
value:function(){var e=this,t=this.gameText[this.currentPage],n=t.split("\n"),r=[];this.animating=!0,this.animatingText=[];for(var i in n){var a=n[i],o=this.add.bitmapText(s,u+i*TILE_HEIGHT,"monospace",a,9);o.alpha=0;var l=this.game.add.tween(o);l.to({alpha:1},200,Phaser.Easing.Linear.None,!1,1e3),r.length>0&&r[r.length-1].chain(l),this.animatingText.push(o),r.push(l)}var c=this.add.bitmapText(s,u+n.length*TILE_HEIGHT,"monospace","...",9);return c.alpha=0,this.ellipsisTween=this.game.add.tween(c),this.ellipsisTween.to({alpha:1},1e3,Phaser.Easing.Linear.None,!1,1e3,-1,!0),r[r.length-1].chain(this.ellipsisTween),r[r.length-1].onComplete.add(function(){e.animating=!1}),r[0].start(),r}},{key:"setupKeyboard",value:function(){var e=this,t=function(){if(e.active){if(e.animating){var t=!0,n=!1,r=void 0;try{for(var i,a=e.tweens[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;o.stop(!0)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}var s=!0,u=!1,l=void 0;try{for(var c,h=e.animatingText[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var f=c.value;f.alpha=1}}catch(e){u=!0,l=e}finally{try{!s&&h.return&&h.return()}finally{if(u)throw l}}return void(e.animating=!1)}e.fadeOut(),e.currentPage<e.gameText.length-1?(e.currentPage++,e.tweens=e.animatePage()):(e.active=!1,e.game.input.keyboard.reset(),e.state.start("level",!0,!1,e.levelIndex))}},n=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER);n.onDown.add(function(){t()});var r=this.game.input.keyboard.addKey(Phaser.Keyboard.M);r.onDown.add(function(){t()})}},{key:"fadeIn",value:function(){var e=this.game.add.graphics();e.beginFill(0,1),e.drawRect(0,0,this.game.width,this.game.height),e.endFill(),e.alpha=1,this.game.add.tween(e).to({alpha:0},500,Phaser.Easing.Linear.None,!0)}},{key:"fadeOut",value:function(){var e=this.game.add.graphics();e.beginFill(0,1),e.drawRect(0,0,this.game.width,this.game.height),e.endFill(),e.alpha=0;var t=this.game.add.tween(e).to({alpha:1},500,Phaser.Easing.Linear.None,!0);return t}}]),t}(Phaser.State);n.default=l},{}]},{},[9]);
//# sourceMappingURL=index.js.map
